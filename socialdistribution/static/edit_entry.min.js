(()=>{function L(){return document.querySelector('meta[name="csrf-token"]').getAttribute("content")}var p={},C=1,i=document.querySelector("#content"),r=document.getElementById("preview"),E=document.querySelector(".editor-container"),f=E.firstElementChild,h=E.lastElementChild,c=document.querySelector("#contentType"),b=document.querySelector("#image"),s="",o="";function y(){c.value==="image"?(f.style.display="none",h.style.display="",i.value="",r.innerHTML="",b.removeAttribute("multiple")):(f.style.display="",h.style.display="",r.innerHTML=convertMarkdownToHtml(d(i.value)),b.setAttribute("multiple",""),s="",o="")}c.addEventListener("change",y);function $(n){return new Promise((e,t)=>{let a=new FileReader;a.onload=()=>{let l=a.result.split(",")[1];e(l)},a.onerror=t,a.readAsDataURL(n)})}function d(n){let e=n;for(let t in p)e=e.replaceAll(`(${t})`,`(${p[t]})`);return e}i.addEventListener("input",()=>{r.innerHTML=convertMarkdownToHtml(d(i.value))});document.addEventListener("DOMContentLoaded",()=>{window.ENTRY_IS_IMAGE?(c.value="image",y(),s=window.ENTRY_CONTENT,o=window.ENTRY_CONTENT_TYPE.replace(";base64",""),o==="application/base64"?r.innerHTML=`<img src="data:${o};base64,${s}" style="max-width:100%;">`:r.innerHTML=`<img src="data:${o};base64,${s}" style="max-width:100%;">`):(c.value=window.ENTRY_CONTENT_TYPE,r.innerHTML=convertMarkdownToHtml(d(i.value)),y())});document.querySelector(".post-btn").addEventListener("click",async n=>{n.preventDefault();let e=document.querySelector("#title").value.trim(),t=document.querySelector('input[name="visibility"]:checked').value.toUpperCase(),a=document.querySelector("#contentType").value,l=d(document.querySelector("#content").value.trim()),m=a;if(a==="image"){if(!s){alert("Please choose an image.");return}l=s,o==="application/base64"?m="application/base64":m=`${o};base64`}let v=window.location.pathname.split("/"),w=v[2],T=v[4],S=`/api/authors/${w}/entries/${T}/`,M={title:e,content:l,description:e,visibility:t,contentType:m};try{let u=await fetch(S,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRFToken":L()},body:JSON.stringify(M)}),g=await u.json();if(!u.ok){console.error("Server error:",g);return}console.log("Success:",g),alert("Post updated successfully!"),window.location.href=`/authors/${w}/entries/${T}/`}catch(u){console.error("Fetch error:",u)}});document.querySelector(".cancel-btn").addEventListener("click",()=>{let n=window.location.pathname.split("/"),e=n[2],t=n[4];window.location.href=`/authors/${e}/entries/${t}/`});document.querySelector("#image").addEventListener("change",async function(){let n=Array.from(this.files).slice(0,15);if(n.length>0)if(c.value==="image"){let e=n[0],t=await $(e);s=t,e.type==="image/png"?o="image/png":e.type==="image/jpeg"?o="image/jpeg":o="application/base64",o==="application/base64"?r.innerHTML=`<img src="data:${o};base64,${t}" style="max-width:100%;">`:r.innerHTML=`<img src="data:${e.type};base64,${t}" style="max-width:100%;">`,this.value=""}else{for(let e of n){let t=await $(e),a=`image${C++}`;p[a]=`data:${e.type};base64,${t}`;let l=`![${e.name}](${a})`;i.value+=(i.value?`

`:"")+l}document.getElementById("preview").innerHTML=convertMarkdownToHtml(d(i.value)),document.querySelector("#contentType").value="text/markdown",this.value=""}});})();
//# sourceMappingURL=edit_entry.min.js.map
