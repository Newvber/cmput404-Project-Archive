(()=>{document.addEventListener("DOMContentLoaded",()=>{let r=document.body.dataset.authenticated==="1",a=document.getElementById("profile-toggle"),o=document.getElementById("profile-menu"),l=document.getElementById("logout-btn");a&&o&&(a.addEventListener("click",e=>{e.stopPropagation(),o.style.display=o.style.display==="block"?"none":"block"}),document.addEventListener("click",()=>{o.style.display="none"})),r&&l&&l.addEventListener("click",async e=>{e.preventDefault(),e.stopPropagation();let s=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");(await fetch("/api/logout/",{method:"POST",credentials:"include",headers:{"X-CSRFToken":s}})).ok?window.location.href="/":alert("Logout failed")});let n=document.getElementById("author-search-input"),t=document.getElementById("search-suggestions");n&&t&&(n.addEventListener("click",async()=>{try{await fetch("/api/sync_remote_authors/")}catch{}}),n.addEventListener("input",async()=>{let e=n.value.trim();if(e.length===0){t.style.display="none";return}try{let i=await(await fetch(`/api/author_autocomplete/?q=${encodeURIComponent(e)}`)).json();t.innerHTML="",i.results.forEach(c=>{let d=document.createElement("li"),u=encodeURIComponent(c.id);d.innerHTML=`
            <div class="suggestion-entry">
              <div class="suggestion-icon">\u{1F464}</div>
              <div class="suggestion-text">
                <div class="display-name">${c.display_name}</div>
                <div class="author-id">${c.id}</div>
              </div>
            </div>
          `,d.addEventListener("click",()=>{window.location.href=`/authors/${u}/`}),t.appendChild(d)}),t.style.display=i.results.length>0?"block":"none"}catch(s){console.error("Autocomplete fetch failed",s),t.style.display="none"}}),document.addEventListener("click",e=>{!t.contains(e.target)&&e.target!==n&&(t.style.display="none")}))});})();
//# sourceMappingURL=navbar.min.js.map
