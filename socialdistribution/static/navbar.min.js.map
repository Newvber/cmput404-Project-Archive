{
  "version": 3,
  "sources": ["../../webapp/navbar.js"],
  "sourcesContent": ["document.addEventListener(\"DOMContentLoaded\", () => {\n  const body = document.body;\n  const isAuth = body.dataset.authenticated === '1';\n\n  const profileToggle = document.getElementById(\"profile-toggle\");\n  const profileMenu = document.getElementById(\"profile-menu\");\n  const logoutBtn = document.getElementById(\"logout-btn\");\n\n  if (profileToggle && profileMenu) {\n    profileToggle.addEventListener(\"click\", (e) => {\n      e.stopPropagation();\n      profileMenu.style.display = profileMenu.style.display === \"block\" ? \"none\" : \"block\";\n    });\n\n    document.addEventListener(\"click\", () => {\n      profileMenu.style.display = \"none\";\n    });\n  }\n\n  if (isAuth && logoutBtn) {\n    logoutBtn.addEventListener(\"click\", async (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const csrftoken = document\n        .querySelector('meta[name=\"csrf-token\"]')\n        ?.getAttribute(\"content\");\n\n      const res = await fetch(\"/api/logout/\", {\n        method: \"POST\",\n        credentials: \"include\",\n        headers: { \"X-CSRFToken\": csrftoken }\n      });\n\n      if (res.ok) {\n        window.location.href = \"/\";\n      } else {\n        alert(\"Logout failed\");\n      }\n    });\n  }\n\n\n  const input = document.getElementById(\"author-search-input\");\n  const suggestions = document.getElementById(\"search-suggestions\");\n\n  if (input && suggestions) {\n    input.addEventListener(\"click\", async () => {\n      try {\n        await fetch(\"/api/sync_remote_authors/\");\n      } catch (_err) {\n        // ignore\n      }\n    });\n\n    input.addEventListener(\"input\", async () => {\n      const query = input.value.trim();\n      if (query.length === 0) {\n        suggestions.style.display = \"none\";\n        return;\n      }\n\n      try {\n        const res = await fetch(`/api/author_autocomplete/?q=${encodeURIComponent(query)}`);\n        const data = await res.json();\n\n        suggestions.innerHTML = \"\";\n        data.results.forEach(author => {\n          const li = document.createElement(\"li\");\n          const encodedId = encodeURIComponent(author.id);\n          li.innerHTML = `\n            <div class=\"suggestion-entry\">\n              <div class=\"suggestion-icon\">\uD83D\uDC64</div>\n              <div class=\"suggestion-text\">\n                <div class=\"display-name\">${author.display_name}</div>\n                <div class=\"author-id\">${author.id}</div>\n              </div>\n            </div>\n          `;\n\n          li.addEventListener(\"click\", () => {\n            window.location.href = `/authors/${encodedId}/`;\n          });\n\n          suggestions.appendChild(li);\n        });\n\n        suggestions.style.display = data.results.length > 0 ? \"block\" : \"none\";\n      } catch (err) {\n        console.error(\"Autocomplete fetch failed\", err);\n        suggestions.style.display = \"none\";\n      }\n    });\n\n    document.addEventListener(\"click\", (e) => {\n      if (!suggestions.contains(e.target) && e.target !== input) {\n        suggestions.style.display = \"none\";\n      }\n    });\n  }\n});\n"],
  "mappings": "MAAA,SAAS,iBAAiB,mBAAoB,IAAM,CAElD,IAAMA,EADO,SAAS,KACF,QAAQ,gBAAkB,IAExCC,EAAgB,SAAS,eAAe,gBAAgB,EACxDC,EAAc,SAAS,eAAe,cAAc,EACpDC,EAAY,SAAS,eAAe,YAAY,EAElDF,GAAiBC,IACnBD,EAAc,iBAAiB,QAAU,GAAM,CAC7C,EAAE,gBAAgB,EAClBC,EAAY,MAAM,QAAUA,EAAY,MAAM,UAAY,QAAU,OAAS,OAC/E,CAAC,EAED,SAAS,iBAAiB,QAAS,IAAM,CACvCA,EAAY,MAAM,QAAU,MAC9B,CAAC,GAGCF,GAAUG,GACZA,EAAU,iBAAiB,QAAS,MAAO,GAAM,CAC/C,EAAE,eAAe,EACjB,EAAE,gBAAgB,EAClB,IAAMC,EAAY,SACf,cAAc,yBAAyB,GACtC,aAAa,SAAS,GAEd,MAAM,MAAM,eAAgB,CACtC,OAAQ,OACR,YAAa,UACb,QAAS,CAAE,cAAeA,CAAU,CACtC,CAAC,GAEO,GACN,OAAO,SAAS,KAAO,IAEvB,MAAM,eAAe,CAEzB,CAAC,EAIH,IAAMC,EAAQ,SAAS,eAAe,qBAAqB,EACrDC,EAAc,SAAS,eAAe,oBAAoB,EAE5DD,GAASC,IACXD,EAAM,iBAAiB,QAAS,SAAY,CAC1C,GAAI,CACF,MAAM,MAAM,2BAA2B,CACzC,MAAe,CAEf,CACF,CAAC,EAEDA,EAAM,iBAAiB,QAAS,SAAY,CAC1C,IAAME,EAAQF,EAAM,MAAM,KAAK,EAC/B,GAAIE,EAAM,SAAW,EAAG,CACtBD,EAAY,MAAM,QAAU,OAC5B,MACF,CAEA,GAAI,CAEF,IAAME,EAAO,MADD,MAAM,MAAM,+BAA+B,mBAAmBD,CAAK,CAAC,EAAE,GAC3D,KAAK,EAE5BD,EAAY,UAAY,GACxBE,EAAK,QAAQ,QAAQC,GAAU,CAC7B,IAAMC,EAAK,SAAS,cAAc,IAAI,EAChCC,EAAY,mBAAmBF,EAAO,EAAE,EAC9CC,EAAG,UAAY;AAAA;AAAA;AAAA;AAAA,4CAImBD,EAAO,YAAY;AAAA,yCACtBA,EAAO,EAAE;AAAA;AAAA;AAAA,YAKxCC,EAAG,iBAAiB,QAAS,IAAM,CACjC,OAAO,SAAS,KAAO,YAAYC,CAAS,GAC9C,CAAC,EAEDL,EAAY,YAAYI,CAAE,CAC5B,CAAC,EAEDJ,EAAY,MAAM,QAAUE,EAAK,QAAQ,OAAS,EAAI,QAAU,MAClE,OAASI,EAAK,CACZ,QAAQ,MAAM,4BAA6BA,CAAG,EAC9CN,EAAY,MAAM,QAAU,MAC9B,CACF,CAAC,EAED,SAAS,iBAAiB,QAAU,GAAM,CACpC,CAACA,EAAY,SAAS,EAAE,MAAM,GAAK,EAAE,SAAWD,IAClDC,EAAY,MAAM,QAAU,OAEhC,CAAC,EAEL,CAAC",
  "names": ["isAuth", "profileToggle", "profileMenu", "logoutBtn", "csrftoken", "input", "suggestions", "query", "data", "author", "li", "encodedId", "err"]
}
