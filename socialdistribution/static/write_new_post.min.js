(()=>{function k(){return document.querySelector('meta[name="csrf-token"]').getAttribute("content")}var m={},L=1,r=document.querySelector("#content"),c=document.getElementById("preview"),w=document.querySelector(".editor-container"),v=w.firstElementChild,g=w.lastElementChild,p=document.querySelector("#contentType"),f=document.querySelector("#image"),u="",a="";function T(){p.value==="image"?(v.style.display="none",g.style.display="",r.value="",c.innerHTML="",f.removeAttribute("multiple")):(v.style.display="",g.style.display="",c.innerHTML=convertMarkdownToHtml(l(r.value)),f.setAttribute("multiple",""),u="",a="")}p.addEventListener("change",T);function h(n){return new Promise((e,t)=>{let o=new FileReader;o.onload=()=>{let i=o.result.split(",")[1];e(i)},o.onerror=t,o.readAsDataURL(n)})}function l(n){let e=n;for(let t in m)e=e.replaceAll(`(${t})`,`(${m[t]})`);return e}r.addEventListener("input",()=>{c.innerHTML=convertMarkdownToHtml(l(r.value))});document.addEventListener("DOMContentLoaded",()=>{c.innerHTML=convertMarkdownToHtml(l(r.value)),T()});document.querySelector(".post-btn").addEventListener("click",async n=>{n.preventDefault();let e=document.querySelector("#title").value.trim(),t=document.querySelector('input[name="visibility"]:checked').value.toUpperCase(),o=document.querySelector("#contentType").value,i=l(document.querySelector("#content").value.trim()),d=o;if(o==="image"){if(!u){alert("Please choose an image.");return}i=u,a==="application/base64"?d="application/base64":d=`${a};base64`}let b=`/api/authors/${window.location.pathname.split("/")[2]}/entries/`,S={title:e,content:i,description:e,visibility:t,contentType:d};try{let s=await fetch(b,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":k()},body:JSON.stringify(S)}),y=await s.json();if(!s.ok){console.error("Server error:",y);return}console.log("Success:",y),alert("Post created successfully!"),window.location.href="/"}catch(s){console.error("Fetch error:",s)}});document.querySelector(".cancel-btn").addEventListener("click",()=>{window.history.back()});document.querySelector("#image").addEventListener("change",async function(){let n=Array.from(this.files).slice(0,15);if(n.length>0)if(p.value==="image"){let e=n[0],t=await h(e);u=t,e.type==="image/png"?a="image/png":e.type==="image/jpeg"?a="image/jpeg":a="application/base64",a==="application/base64"?c.innerHTML=`<img src="data:${a};base64,${t}" style="max-width:100%;">`:c.innerHTML=`<img src="data:${e.type};base64,${t}" style="max-width:100%;">`,this.value=""}else{for(let e of n){let t=await h(e),o=`image${L++}`;m[o]=`data:${e.type};base64,${t}`;let i=`![${e.name}](${o})`;r.value+=(r.value?`

`:"")+i}document.getElementById("preview").innerHTML=convertMarkdownToHtml(l(r.value)),document.querySelector("#contentType").value="text/markdown",this.value=""}});})();
//# sourceMappingURL=write_new_post.min.js.map
